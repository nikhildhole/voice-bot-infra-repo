apiVersion: v1
kind: ConfigMap
metadata:
  name: kong-values
  namespace: kong
data:
  values.yaml: |
    env:
      database: "off"

    proxy:
      type: NodePort

      http:
        enabled: true

      # --- ENABLE RAW TCP STREAMING ---
      stream:
        tcp:
          - name: audio-stream
            containerPort: 9000   # Kong listens on this port inside container
            servicePort: 9000     # Exposed by the K8s Service
            # nodePort: 32000     # (Optional) uncomment for fixed NodePort

    ingressController:
      enabled: true
      ingressClass: kong
      admissionWebhook:
        enabled: false

    autoscaling:
      enabled: true
      minReplicas: 1
      maxReplicas: 1

    resources:
      limits:
        cpu: 500m
        memory: 512Mi